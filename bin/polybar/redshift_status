#!/usr/bin/env bash

# Polybar icons
ICON_ON=""
ICON_OFF=""

# Redshift config
DAY_TEMP=4500
DAY_BRIGHTNESS=1.0

NIGHT_TEMP=3500
NIGHT_BRIGHTNESS=0.7

check_redshift() {
    if [ "$(pgrep -x redshift)" ]; then
        echo $ICON_ON
    else
        echo $ICON_OFF
    fi
}

toggle_redshift() {
    if [ ! "$(pgrep -x redshift)" ]; then
        redshift -t $DAY_TEMP:$NIGHT_TEMP -b $DAY_BRIGHTNESS:$NIGHT_BRIGHTNESS &>/dev/null &
    else
        while pgrep -x redshift >/dev/null; do killall -q redshift; sleep 1; done
    fi
}

case $1 in 
    check) check_redshift ;;
    toggle) toggle_redshift && check_redshift ;;
esac
